{% for category in categories %}
<tr>
    <td>{{ category.category }}</td>
    <td>
        <select class="subcategory-select form-control" data-category="{{ category.category | urlencode | replace('\'', '\\\'') | replace('\"', '\\\"') }}" onchange="loadCommonNames(this)">
            <option value="">Select a subcategory</option>
        </select>
        <div id="loading-subcat-{{ category.cat_id }}" class="loading-indicator" style="display: none;">Loading...</div>
    </td>
    <td>{{ category.total_items }}</td>
    <td>{{ category.items_on_contracts }}</td>
    <td>{{ category.items_in_service }}</td>
    <td>{{ category.items_available }}</td>
    <td>
        <button class="btn btn-sm btn-secondary expand-btn" 
                data-category="{{ category.category | urlencode | replace('\'', '\\\'') | replace('\"', '\\\"') }}" 
                data-target-id="common-{{ category.cat_id }}">Expand</button>
        <button class="btn btn-sm btn-secondary collapse-btn" 
                style="display:none;" 
                data-collapse-target="common-{{ category.cat_id }}">Collapse</button>
        <button class="btn btn-sm btn-info print-btn" 
                data-print-level="Category" 
                data-print-id="category-table">Print</button>
        <div id="loading-{{ category.cat_id }}" style="display:none;" class="loading">Loading...</div>
    </td>
</tr>
<tr>
    <td colspan="7">
        <div id="common-{{ category.cat_id }}" class="expandable collapsed common-level"></div>
    </td>
</tr>
{% endfor %}